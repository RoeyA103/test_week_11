#download ripo from git hub
 git clone https://github.com/yosefanaliza/streamlit_minikube_app

#start the minikube server
minikube start

#check minikube status 
minikube status

#create dockerfie branch
git branch dockerfile

#change to the dockerfile branch
git checkout dockerfile

#create Dockerfile inside your app directory 
echo "" > Dockerfile

#Enter the following content

"FROM python:3.10-slim

WORKDIR /app

COPY requirements.txt .

RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8080

CMD [ "streamlit", "run" ,"main.py" ,"--server.port", "8080" ,"--server.address=0.0.0.0" ]"

#add dockerignore file

echo "" > .dockerignore

# Enter the following content
.git/
__pychach__/

# connect to your docker hub
docker login 

#inside the app folder
docker build -t your_yusername/myapp:latest .

# add to docker hub
docker push your_yusername/myapp:latest

#after it finished check it it working localy
docker run -p 8080:8080 myapp:latest

#check container status
docker ps

# copy the contianer hash and chack logs
docker logs {hash}

#for more information 
docker inspect {hash}


#chack localy from your brows
open http://localhost:8080

#save and commit and push changes

git add . 
git commit -m "your massage"
git push origin dockerfile

#create pod branch
git branch podyaml

#change to the dockerfile branch
git checkout podyaml

#create pod.yaml 
echo "" > pod.yaml

# Enter the following content

apiVersion: v1
kind: Pod
metadata:
  name : streamlit
  labels:
    app: pod-app
spec:
  containers:
  - name: streamlit
    image: roeyaverbuch/myapp:latest


# check if it working
kubectl apply -f pod.yaml

# check if it working
kubectl get pods

# check status
kubectl logs {pod name}

#save and commit and push changes

git add . 
git commit -m "your massage"
git push origin podyaml

# create service branch
git branch serviceyaml

# change to new branch
git checkout serviceyaml

# create service.yaml

echo "" > service.yaml

# Enter the following content
apiVersion: v1
kind: Service
metadata:
    name: streamlit
spec:
    selector:
        app: pod-app
    ports:
    - port: 8080
      targetPort: 8080

#start the service
kubectl apply -f service.yaml

# check if it working
kubectl get svc

#expose the service to the host with minikube
minikube service streamlit

#create screenshoe branch
git branch screenshot

#change to the new branch
git checkout screenshot

#afterr adding the screenshot + readme file
git add .
git commit -m "adding screenshot + readme"
git push origin screenshot


 


